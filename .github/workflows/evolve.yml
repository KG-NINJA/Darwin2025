name: ğŸ§¬ Darwin2025 Evolver (mini mode)

on:
  schedule:
    - cron: "0 3 * * 1"   # JSTæ­£åˆï¼ˆæœˆæ›œï¼‰
  workflow_dispatch:

permissions:
  contents: write

jobs:
  evolve:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: ğŸ§  Read and evolve evol.md (steady evolution)
        uses: openai/codex-action@v1
        with:
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
          model: gpt-4o-mini          # â† åœ°å‘³ã§å®‰å®šã—ãŸé€²åŒ–
          safety-strategy: unsafe
          prompt: |
            ã‚ãªãŸã¯é™ã‹ã«é€²åŒ–ã™ã‚‹AIç ”ç©¶è€…ã§ã™ã€‚
            ç¾åœ¨ã® evol.md ã‚’èª­ã¿å–ã‚Šã€
            å…ˆé€±ã®åçœç‚¹ã¨é€²æ­©ã‚’è¦ç´„ã—ã¦ãã ã•ã„ã€‚
            ãã®ä¸‹ã«æ–°ã—ã„ç« ã‚’è¿½åŠ ã—ã¾ã™ã€‚

            ## æ¬¡ã®é€²åŒ–è¨ˆç”»ï¼ˆ{{ date }}ï¼‰
            - æ”¹å–„ææ¡ˆã¯æ§ãˆã‚ã§ç¾å®Ÿçš„ã«ã€‚
            - ç„¡ç†ãªæ‹¡å¼µã§ã¯ãªãã€ç¶™ç¶šæ€§ã‚’é‡è¦–ã€‚
            - é€²åŒ–ã¯å°‘ã—ãšã¤ã€ã—ã‹ã—ç¢ºå®Ÿã«è¡Œã†ã€‚
            - å¿…ãšæ—¥æœ¬èªã§æ›¸ãã€éå»ãƒ­ã‚°ã¯ä¿æŒã™ã‚‹ã€‚

            å‡ºåŠ›å½¢å¼ã¯å…ƒã® evol.md ã®æ§‹é€ ã‚’ç¶­æŒã—ã€
            è¿½è¨˜éƒ¨åˆ†ã¯ä¸€ç•ªä¸‹ã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
          output-file: evol.md

      - name: ğŸ’¾ Commit updated evol.md
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add evol.md
          git diff --staged --quiet || git commit -m "ğŸ§¬ Evol.md auto-evolved (mini update)"
          git push
