name: ğŸ§¬ Darwin2025 Evolver (daily mini mode)

on:
  schedule:
    - cron: "0 3 * * *"   # JSTæ­£åˆã«æ¯æ—¥å®Ÿè¡Œï¼ˆUTC 03:00ï¼‰
  workflow_dispatch:

permissions:
  contents: write

jobs:
  evolve:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: ğŸ§  Read and evolve evol.md (daily micro evolution)
        uses: openai/codex-action@v1
        with:
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
          model: gpt-4o-mini          # é™ã‹ã§å®‰å®šã—ãŸé€²åŒ–
          safety-strategy: unsafe
          prompt: |
            ã‚ãªãŸã¯é™ã‹ã«é€²åŒ–ã™ã‚‹AIç ”ç©¶è€…ã§ã™ã€‚
            ç¾åœ¨ã® evol.md ã‚’èª­ã¿å–ã‚Šã€
            æ˜¨æ—¥ã¾ã§ã®åçœç‚¹ã¨æ”¹å–„ã‚’è¦ç´„ã—ã¦ãã ã•ã„ã€‚
            ãã®ä¸‹ã«æ–°ã—ã„ç« ã‚’è¿½åŠ ã—ã¾ã™ã€‚
            ## æ¬¡ã®é€²åŒ–è¨ˆç”»ï¼ˆ{{ date }}ï¼‰
            - æ”¹å–„ææ¡ˆã¯æ§ãˆã‚ã§ç¾å®Ÿçš„ã«ã€‚
            - ç„¡ç†ãªæ‹¡å¼µã§ã¯ãªãã€ç¶™ç¶šæ€§ã‚’é‡è¦–ã€‚
            - æ—¥ã€…å°‘ã—ãšã¤ã€ã—ã‹ã—ç¢ºå®Ÿã«æˆé•·ã™ã‚‹ã€‚
            - å¿…ãšæ—¥æœ¬èªã§æ›¸ãã€éå»ãƒ­ã‚°ã¯ä¿æŒã™ã‚‹ã€‚
            å‡ºåŠ›å½¢å¼ã¯å…ƒã® evol.md ã®æ§‹é€ ã‚’ç¶­æŒã—ã€
            æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¸€ç•ªä¸‹ã«è¿½è¨˜ã—ã¦ãã ã•ã„ã€‚
          output-file: evol.md

      - name: ğŸ’¾ Commit updated evol.md
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add evol.md
          git diff --staged --quiet || git commit -m "ğŸ§¬ Daily micro-evolution (mini update)"
          git push
